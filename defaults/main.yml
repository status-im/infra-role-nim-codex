---
nim_codex_service_name: 'nim-codex-{{ nim_codex_repo_branch }}'
nim_codex_service_path: '/data/{{ nim_codex_service_name }}'
nim_codex_data_folder: '{{ nim_codex_service_path }}/data'
nim_codex_repo_path: '{{ nim_codex_service_path }}/repo'
nim_codex_logs_link: '{{ nim_codex_service_path }}/logs'

nim_codex_user: 'codex'
nim_codex_group: 'staff'

# Build
nim_codex_build_service_name: 'build-{{ nim_codex_service_name }}'
nim_codex_build_timer_enabled: true
nim_codex_build_timer_timeout: 3600
nim_codex_build_frequency: 'daily'
nim_codex_build_days_kept: 3
nim_codex_build_jobs: '{{ ansible_processor_vcpus / 2 | round(0, "ceil") }}'
nim_codex_build_log_level: 'TRACE'
nim_codex_build_restarts_service: true
nim_codex_build_nim_flags: >-
  -d:noSignalHandler

nim_codex_repo_url: 'https://github.com/status-im/nim-dagger'
nim_codex_repo_branch: 'main'

# Logs
nim_codex_log_level: 'INFO' # TRACE DEBUG INFO NOTICE WARN ERROR FATAL NONE

# connectivity settings
nim_codex_public_address: '{{ ansible_host }}'
nim_codex_max_peers: 160
nim_codex_listening_port: 9000

# Scraping of metrics done via VPN. Protected by firewall.
nim_codex_metrics_enabled: true
nim_codex_metrics_address: '0.0.0.0'
nim_codex_metrics_port: 9200
nim_codex_rest_port: 5052

# Size in MiB
nim_codex_cache_size: 100

# Consul service definition settings
nim_codex_consul_service_name: 'nim-codex'
nim_codex_consul_service_file_name: '{{ nim_codex_service_name | replace("-", "_") }}'
nim_codex_consul_metrics_service_name: '{{ nim_codex_consul_service_name }}-metrics'

# Which version of Nim to use for the build
# By default, it would use the one specified by the pinned nimbus-build-system
nim_codex_nim_commit: ''
